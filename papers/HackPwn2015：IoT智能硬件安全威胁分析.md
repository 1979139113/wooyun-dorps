# HackPwn2015：IoT智能硬件安全威胁分析

IoT（物联网）是一种既危险又有趣的混合技术,所谓的混合技术包括`移动应用程序`、`蓝牙`、`Wi-Fi、zigbee`、`设备固件`、`服务`、`API`、以及`各种网络协议`等如图。这些技术从独立上来看都是相对安全且成熟的。但是要将这些技术结合应用起来，没有安全贯穿整个应用流程，就会出现安全问题。 在2015年8月21日举行的首届HackPwn2015安全极客狂欢节上，来自国内外的安全极客针对IoT智能硬件设备进行了报名破解，包括智能交通、智能娱乐、智能终端、智能生活和O2O业务等市面上流行的产品在本次比赛中暴露出一系列高危漏洞和影响用户财产甚至生命安全的真实威胁，这也为各大智能硬件厂商敲响了警钟。

![enter image description here](http://drops.javaweb.org/uploads/images/cafd67325ff9ae1fd532ea31423337f0c0fa7752.jpg)

0x00 智能硬件技术架构
=====

IoT技术应用虽然复杂，但是从逻辑上来看可以把它的技术架构分为：`云端`、`设备终端`、`手机终端`三个方面。主要能够实现的流程就是通过手机端下载APP，与云端进行通信，发送控制指令，在由云端转发控制指令给设备终端。这样就能够实现，在任意能够接入互联网的环境下，去控制一台在内网的智能设备，从而实现智能化。如图

![enter image description here](http://drops.javaweb.org/uploads/images/203653f805dd8fe81ed3a1fb7281202e570eab4d.jpg)

通过对智能硬件成熟应用测试的结果，可以根据信息数据的流向，把数据交互的信息点列为攻击面。以此可以划分为`固件`、`APK`、`云端API`这三个信息点。在每个信息点上都会有数据的存储，交互，控制的流程。通过分析发现，固件中包含的设备与云端交互数据、设备与本地手机交互数据。手机安装的APK中包含手机与云端交互数据、手机与本地设备交互数据。云端服务器包含手机与设备的绑定关系、远程管理、反向代理业务的数据。然后再根据身份验证、传输加密、和访问控制这几个安全措施的符合度去判断，是否存在漏洞。

0x01 HackPwn-颠覆智能硬件破解的定义
=====

传统的智能硬件破解都是在对设备硬件架构和对设备固件进行分析的前提下，通过物理接触改变设备原有功能，或者增加设备原有设计中没有的功能。或者突破系统内置的用户身份验证机制控制设备。正因为IoT技术的应用，使得此次HackPwn活动中大部分的参赛的选手都是采用在不接触和对设备进行拆解的情况下。利用设备自身原有的功能，通过远程攻击的手段绕过用户身份验证机制控制设备，从而获得设备的控制权限。

![enter image description here](http://drops.javaweb.org/uploads/images/32d720fef581d8990c04d3c9585e0359918c2f78.jpg)

0x02 绕过各大物联网控制平台
=====

各大互联网公司进军IoT领域中所定位的位置，就是开发统一的物联网接入平台，然后为创业公司设备提供快速、安全、稳定的接入物联网的一体化解决方案。让硬件设备开发者更加聚焦在硬件设计与功能创新本身。只要创业公司按照物联网平台所发布的接口进行定制开发，就能够实现通过各大互联网公司的应用统一调用设备。

![enter image description here](http://drops.javaweb.org/uploads/images/4438c231643c298caa06e97833879725fc8b44be.jpg)

通过分析验证，在这些物联网平台和手机之间。都具备高强度的加密传输和身份认证的方案，在进行分析过程中，可以发现物联网平台在安全方面还是考虑的比较多的。在短时间要攻破物联网平台比较难。所以把攻击点定位在第三方平台和设备之间。

![enter image description here](http://drops.javaweb.org/uploads/images/59f0965610fb43c2272c14f806284b2b065c68a7.jpg)

但是在实际控制流程过程分析中发现的是，大多数控制指令都是由第三方平台转发给设备，物联网平台都起到统一认证和控制的功能。通过分析设备和第三方平台之间的数据和控制信息可以实现绕过认证对设备的远程控制。并且能够控制同一品牌下的所有设备。HackPwn活动中智能烤箱、智能洗衣机等设备都是通过这一攻击点进行远程攻击的。

![enter image description here](http://drops.javaweb.org/uploads/images/78a981028239d954bd55490f0f25a996f7d7f418.jpg)

![enter image description here](http://drops.javaweb.org/uploads/images/04a4b35d4ec50094a7a4491a21c7a4c7b920789d.jpg)

经我们研究发现国内主流的一些智能家居设备，接入到物联网平台中也有可能存在同样的问题。

0x03 传输过程未加密造成的安全隐患
=====

HackPwn比赛中，参赛选手的智能硬件漏洞也有很多是因为厂商在传输加密方面没有做到位，能够分析到设备和云端之间的控制指令，或者分析手机和云端发送的控制指令。在通过重放手机控制指令的方法，从而控制设备。这之间当然会有身份验证信息，重放也不是一件容易的事情。传输过程未加密除了会造成设备被劫持控制，还会泄露智能硬件在使用的过程中产生的数据，比如地理位置、使用者手机号、手机的IMEI号等。这足以能够反映出个人的使用习惯。

![enter image description here](http://drops.javaweb.org/uploads/images/2008b7b057ffe278b11ad54bc9e708a87fba8ab2.jpg)

0x04 无线电成为智能家居下一个的攻击点
=====

智能家居安防设备形同虚设，在HackPwn比赛中有一类是智能家居安防设备。这类设备本来就是使用各类的传感器，门磁、烟雾报警感应、红外线移动感应器等设备，通过互联网盒子与手机相连接。如果家里有异常触发这些传感器，就可以通过手机立马看到。可以让用户感觉到安心。但是市面上大多数智能家居设备传感器与互联网报警设备的连接方式都是采用RF或者zigbee。可以使用SDR技术通过重放无线电信号从而实现“误报”或者“干扰”攻击，这使智能家居安防类设备降低了告警的可信度。失去了它真实的意义。

0x05 总结
=====

现在的IoT技术就是在传统物联网技术应用基础之上，把所有的智能硬件接入互联网，通过传感器采集生活数据，结合制定舒适的控制策略，控制相应的家电设备。使得家庭、生活，达到一定程度的智能化。但这一些都要承载在信息安全的基础之上，HackPwn活动的举办正是为让智能硬件创业厂商、物联网平台接入商敲响了警钟。提示大家智能硬件的安全风险不容忽视。同时也推动厂商提高产品的安全性，为大家带来更有安全感的智能生活。